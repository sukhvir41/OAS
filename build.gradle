buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath 'com.bmuschko:gradle-cargo-plugin:2.4'
    }
}

plugins {
    id 'war'  
    id 'net.ltgt.apt' version '0.10'
    id 'io.franzbecker.gradle-lombok' version '1.14'

}

apply plugin: 'com.bmuschko.cargo'



sourceCompatibility = '1.8'
[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'


if (!hasProperty('mainClass')) {
    ext.mainClass = ''
}

repositories {
    mavenCentral()
    jcenter()
}

dependencies {
    cargo 'org.codehaus.cargo:cargo-core-uberjar:1.6.9',
            'org.codehaus.cargo:cargo-ant:1.6.9'
    providedCompile 'javax.servlet:javax.servlet-api:4.0.0'
    
    compileOnly 'org.projectlombok:lombok:1.18.2'
    apt "org.projectlombok:lombok:1.18.2"

    compile group: 'org.postgresql', name: 'postgresql', version: '42.2.4'
    compile group: 'javax.mail', name: 'javax.mail-api', version: '1.6.1'
    
    compile group: 'com.google.code.gson', name: 'gson', version: '2.8.5'
    compile group: 'org.pcap4j', name: 'pcap4j-packetfactory-static', version: '1.7.3'
    compile group: 'org.hibernate', name: 'hibernate-core', version: '4.3.11.Final'
    compile 'javax.websocket:javax.websocket-api:1.1'
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile group: 'javax.servlet', name: 'jstl', version: '1.2'



   
    testCompile group: 'junit', name: 'junit', version: '4.10'
    testCompile 'org.mockito:mockito-core:2.7.19'
}

lombok {
    version = "1.16.20"
    sha256 = "c5178b18caaa1a15e17b99ba5e4023d2de2ebc18b58cde0f5a04ca4b31c10e6d"
}

cargo {
    containerId = 'tomcat9x'
    port = 8080

    deployable {
        context = '/OAS'
    }

    local {
        homeDir = file('C:\\Program Files\\Apache Software Foundation\\Tomcat 9.0')
        outputFile = file('output.log')
    }
}


task runApplication(){
    dependsOn clean
    dependsOn build
    dependsOn cargoStopLocal
    dependsOn cargoRunLocal
    
    println('Done!!')
}